/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.14.3/samples
 */

buildscript {
    ext.kotlin_version = '1.9.23'
    ext.dokka_version = '2.0.0'
    repositories {
        gradlePluginPortal()
        mavenCentral()
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
        classpath "org.jetbrains.dokka:dokka-gradle-plugin:$dokka_version"
    }
}

plugins {
    id 'base'
    id 'org.jreleaser' version '1.20.0'
}

jreleaser {
    dryrun = false

    project {
        name = "ivk-skill-sdk"
        description = "Kotlin SDK for IVK Skill"
        authors = ["Robin Van Cauter"]
        license = "Apache-2.0"
        version = file("skill-sdk/version.txt").text.trim()
        links {
            homepage = "https://github.com/invokation-games/kotlin-sdk"
        }
        java {
            groupId = 'dev.ivk'
            version = file("skill-sdk/version.txt").text.trim()
        }
    }

    release {
        github {
            enabled = false
        }
    }

    signing {
        active = 'ALWAYS'
        armored = true
        verify = true
    }

    deploy {
        maven {
            mavenCentral {
                sonatype {
                    active = 'ALWAYS'
                    url = 'https://central.sonatype.com/api/v1/publisher'
                    stagingRepository('build/staging-deploy')
                }
            }
        }
    }
}

def javaProjects = [
        project(":skill-sdk"),
        project(":example"),
]

configure(javaProjects) {
    println "${project.name}"
    apply plugin: 'org.jetbrains.kotlin.jvm'
    repositories {
        mavenCentral()
    }

    dependencies {
        // Add Kotlin stdlib to all projects
        implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
    }

    test {
        useJUnitPlatform()
    }
}

project(":example") {
    apply plugin: 'application'
    version '1.0.0'
}
